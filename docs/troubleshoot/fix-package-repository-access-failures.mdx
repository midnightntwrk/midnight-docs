---
title: Fix package repository access failures
description: Resolve 403 Forbidden errors when installing Midnight npm packages with three proven solutions.
sidebar_label: Fix package repository issues
sidebar_position: 7
tags: [npm, installation, errors]
slug: /how-to/fix-package-repository-access-failures
toc_max_heading_level: 2
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import Step, { StepsProvider } from "@site/src/components/Step/Step";

# Fix package repository access failures

Resolve 403 Forbidden errors encountered when installing Midnight packages.

## Understand the cause of the error

When installing Midnight packages, you might encounter a 403 Forbidden error. This error typically appears when your npm configuration points to an incorrect registry or when network restrictions block access:

```bash
npm install @midnight-ntwrk/compact-runtime

npm ERR! code E403
npm ERR! 403 Forbidden - GET https://registry.npmjs.org/@midnight-ntwrk/compact-runtime
npm ERR! 403 In most cases, you or one of your dependencies are requesting
npm ERR! 403 a package version that is forbidden by your security policy
```

The following solutions address the most common causes of this error, starting with the simplest fix.

## Solution 1: Reset npm registry

The most common cause is an npm configuration pointing to the wrong registry. Reset the npm registry to the default public npm registry to resolve this issue.

<StepsProvider>

<Step>

### Check current registry

Check which registry npm is currently configured to use:

```bash
npm config get registry
```

If the output differs from `https://registry.npmjs.org/`, then the registry configuration is incorrect and needs resetting.

</Step>

<Step>

### Reset to default registry

Reset the npm registry configuration to the default public registry, remove any scoped registry settings, and clear the npm cache:

```bash
npm config set registry https://registry.npmjs.org/
npm config delete @midnight-ntwrk:registry
npm cache clean --force
```

</Step>

<Step>

### Test installation

```bash
npm install @midnight-ntwrk/compact-runtime
```

**Verification**: Package installs successfully without errors.

</Step>

</StepsProvider>

## Solution 2: Fix VPN and proxy issues

If resetting the registry does not resolve the issue, VPN connections or corporate proxy servers may be blocking npm access. 
Try these steps to configure npm to work with your network setup.

<StepsProvider>

<Step>

### Disable VPN temporarily

:::info Corporate Networks
On corporate networks, disabling a VPN connection may not be permitted.
:::

Disconnect from the VPN and test:

```bash
npm install @midnight-ntwrk/compact-runtime
```

If the installation succeeds, VPN restrictions are blocking npm access. Configure proxy settings instead.

</Step>

<Step>

### Configure proxy (if VPN is required)

If you must remain connected to a VPN, configure npm to use your corporate proxy server. Replace `proxy.company.com:8080` with your actual proxy address:

```bash
# Set proxy settings
npm config set proxy http://proxy.company.com:8080
npm config set https-proxy http://proxy.company.com:8080

# With authentication (if required)
npm config set proxy http://username:password@proxy.company.com:8080
npm config set https-proxy http://username:password@proxy.company.com:8080
```

</Step>

<Step>

### Test installation

```bash
npm install @midnight-ntwrk/compact-runtime
```

**Verification**: Package installs successfully through proxy.

</Step>

</StepsProvider>

## Solution 3: Clear configuration and start fresh

If the previous solutions do not work, conflicting npm configurations may be causing the error. 
Clear all npm settings and restore default configurations to eliminate any misconfigurations.

<StepsProvider>

<Step>

### Back up and clear configuration

:::warning Important
Back up the npm configuration before clearing it, as this process removes all custom settings.
:::

```bash
# Back up existing config
cp ~/.npmrc ~/.npmrc.backup

# Remove all settings
npm config delete registry
npm config delete proxy
npm config delete https-proxy
npm config delete @midnight-ntwrk:registry
```

</Step>

<Step>

### Set defaults and clean project

:::caution Data Loss Warning
The following commands delete node_modules and package-lock.json. Ensure the correct project directory is active before proceeding.
:::

```bash
# Set registry
npm config set registry https://registry.npmjs.org/

# Clean project
rm -rf node_modules package-lock.json
npm cache clean --force
```

</Step>

<Step>

### Test installation

```bash
npm install @midnight-ntwrk/compact-runtime
```

**Verification**: Package installs successfully.

</Step>

</StepsProvider>

## Platform-specific fixes

Some npm access issues are specific to particular operating systems or environments. Use these platform-specific solutions if the general fixes above do not resolve your issue.

<Tabs>
<TabItem value="windows" label="Windows/WSL">

On Windows Subsystem for Linux (WSL), line ending issues and cache conflicts between Windows and WSL can cause npm errors. Use these commands to resolve WSL-specific issues:

```bash
# Configure git line endings
git config --global core.autocrlf false

# Use native WSL paths (not /mnt/c/...)
cd /home/yourusername/project

# Clear Windows npm cache
rm -rf /mnt/c/Users/YourName/AppData/Roaming/npm-cache
```

Replace `yourusername` and `YourName` with your actual username.

</TabItem>
<TabItem value="linux" label="Linux">

On Linux, permission errors can occur when npm tries to install packages globally. Configure npm to use a directory in your home folder instead of requiring sudo:

```bash
# Configure npm without sudo
mkdir ~/.npm-global
npm config set prefix '~/.npm-global'

# Add to ~/.bashrc
export PATH=~/.npm-global/bin:$PATH
source ~/.bashrc
```

After running these commands, npm installs global packages to `~/.npm-global` without requiring elevated permissions.

</TabItem>
<TabItem value="mac" label="macOS">

On macOS, cached credentials in the system keychain can cause authentication issues with npm. Clear these credentials to force npm to authenticate fresh:

:::note macOS security
The system may prompt for your password when running this command.
:::

```bash
# Clear keychain credentials
security delete-generic-password -s 'npm' -a 'bearer'
```

If the command returns an error saying the password was not found, no credentials were stored and you can proceed with other solutions.

</TabItem>
</Tabs>

## Quick fix script

For convenience, you can create an automated shell script that applies multiple fixes at once. 
This script resets npm configuration, clears caches, and tests the installation:

```bash title="fix-midnight-npm.sh"
#!/bin/bash

echo "üîß Fixing Midnight npm installation..."

# Clear configuration
npm config delete registry
npm config delete @midnight-ntwrk:registry
npm config delete proxy
npm config delete https-proxy

# Set defaults
npm config set registry https://registry.npmjs.org/
npm cache clean --force

# Clean project (only if package.json exists)
if [ -f "package.json" ]; then
    echo "üìÅ Cleaning project files..."
    rm -rf node_modules package-lock.json
else
    echo "‚ö†Ô∏è  No package.json found - skipping project cleanup"
fi

# Test installation
echo "üß™ Testing package installation..."
npm install @midnight-ntwrk/compact-runtime

if [ $? -eq 0 ]; then
    echo "‚úÖ Success! Midnight packages are accessible."
else
    echo "‚ùå Installation failed. Try disconnecting from VPN or checking firewall settings."
fi
```

Make the script executable and run it:

```bash
chmod +x fix-midnight-npm.sh
./fix-midnight-npm.sh
```

## Verify the fix

After applying the fixes, confirm that all configurations are correct and installations work properly:

```bash
# Check registry
npm config get registry
# Expected output: https://registry.npmjs.org/

# Test package access
npm view @midnight-ntwrk/compact-runtime
# Expected output: package information

# Verify installation
npm install @midnight-ntwrk/compact-runtime
# Expected result: successful installation
```

## Still not working?

If none of the solutions above resolve the issue, use these advanced debugging techniques to identify the root cause.

<details>
<summary><strong>Enable verbose logging</strong></summary>

Display detailed error information by running npm with the verbose flag:

```bash
npm install @midnight-ntwrk/compact-runtime --verbose
```

Common issues revealed by verbose logging include:

- SSL certificate validation failures.
- Proxy configuration errors or authentication issues.
- DNS resolution failures when contacting the registry.

</details>

<details>
<summary><strong>Test direct connection</strong></summary>

Verify registry access:

```bash
curl https://registry.npmjs.org/@midnight-ntwrk/compact-runtime
```

A failed request indicates a network connectivity issue.

</details>

## Next steps

After successfully installing Midnight packages, verify that your development environment is properly configured and the packages are working correctly:

```bash
# Check installed packages
npm list @midnight-ntwrk

# Verify compiler
compact --version

# Test runtime import
node -e "const runtime = require('@midnight-ntwrk/compact-runtime'); console.log('‚úÖ Runtime loaded');"
```