---
SPDX-License-Identifier: Apache-2.0
copyright: This file is part of midnight-docs. Copyright (C) 2025 Midnight Foundation. Licensed under the Apache License, Version 2.0 (the "License"); You may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
sidebar_label: "Register for DUST generation"
---

import { Step, StepsProvider } from '@site/src/components/Step';

# Register for DUST generation

Link a **Cardano wallet** to a **Midnight DUST address** so that newly received **cNIGHT UTxOs** begin generating DUST to the mapped destination once the registration is relayed.

## Prerequisites

- Cardano wallet
- Midnight DUST address (the destination for generated DUST)

## Steps

### Provide the two addresses

<StepsProvider>
  <Step>Collect your <strong>Cardano wallet address</strong> (generator) and <strong>Midnight DUST address</strong> (recipient).</Step>
  <Step>Provide them via one of: <em>DApp registration flow</em>, <em>Glacier Drop redemption</em>, or <em>CLI/SDK</em> that builds the same transaction.</Step>
</StepsProvider>

### Check whether you’re already registered

<StepsProvider>
  <Step>Verify there is <strong>no valid registration UTxO</strong> already associated with the Cardano wallet. Duplicate registrations must be rejected.</Step>
</StepsProvider>

:::note
If a registration exists but the DUST address must change, first **update** (deregister + new register in one tx) or **deregister** before proceeding.
:::

### Create the mapping UTxO on Cardano

<StepsProvider>
  <Step>Construct a transaction that <strong>generates a UTxO at the mapping validator</strong> with a datum mapping <code>CardanoAddress</code> → <code>DUSTAddress</code> (inline datum per CIP-0032 acceptable).</Step>
  <Step>Sign and submit the transaction.</Step>
  <Step>Record the resulting <code>txHash</code> for audit/troubleshooting.</Step>
</StepsProvider>

### Allow indexing and relay to Midnight

<StepsProvider>
  <Step>The observability layer detects the registration UTxO on Cardano and <strong>relays</strong> the mapping.</Step>
  <Step>The Midnight node updates its internal list of <strong>registered wallets</strong> and validates the mapped DUST address.</Step>
  <Step><strong>After relay:</strong> any newly received <strong>cNIGHT UTxOs</strong> for this wallet begin generating DUST to the mapped address.</Step>
</StepsProvider>

### Confirm you’re registered

<StepsProvider>
  <Step>Query the node’s public status to confirm the wallet is <strong>Registered</strong> and the mapped DUST address is <strong>Valid</strong>.</Step>
  <Step>From now on, newly created <strong>cNIGHT UTxOs</strong> at this wallet generate DUST to the mapped Midnight address.</Step>
</StepsProvider>

## Status states developers should surface

- <strong>Pending</strong>: registration UTxO observed on Cardano; ingestion/relay in progress.  
- <strong>Registered</strong>: mapping accepted by the node; DUST generation active for newly received cNIGHT UTxOs.  
- <strong>Not Registered</strong>: no valid mapping recognized by the node.

:::tip
During long ingestion/relay windows, status may appear <em>pending</em>. Refresh after indexing completes.
:::
