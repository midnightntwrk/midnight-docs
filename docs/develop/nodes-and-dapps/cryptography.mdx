---
SPDX-License-Identifier: Apache-2.0
copyright: This file is part of midnight-docs. Copyright (C) 2025 Midnight Foundation. Licensed under the Apache License, Version 2.0 (the "License"); You may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
id: cryptography
title: Cryptography
sidebar_label: Cryptography
description: A reference on cryptography in Midnight nodes.
keywords: [node]
---

# Cryptography

Outside of the Midnight Ledger, which contains its own specialized cryptographic circuits, the Midnight node relies on several foundational cryptographic algorithms for securing core functions such as consensus, state transition integrity, and network communication.

The primary hash function used is **Blake2 256**, which provides strong cryptographic guarantees and is employed for general-purpose hashing â€” including block hashes and within various state transition functions. It strikes a balance between performance and security, making it suitable for runtime-critical operations.

For signature verification, Midnight uses three distinct schemes depending on the role:

- **sr25519**, based on the Schnorrkel and Ristretto x25519 construction, is used for signing block authorship messages in the AURA consensus mechanism. It supports efficient key derivation, signature aggregation, and strong security properties.
  
- **ECDSA** is used specifically for signing consensus-related messages associated with Partnerchains. This ensures interoperability with external systems that adopt ECDSA as a standard.
  
- **Ed25519** is employed in two areas of the Midnight node:
1. for signing finality-related messages in the GRANDPA protocol, offering a fast and secure mechanism for verifying validator communications during finalization.
2. for signing messages sent as part of the underlying libp2p protocols implemented in Polkadot SDK

Additionally, the Midnight node uses **twoxhash** as a non-cryptographic hash function for generating storage keys. While not suitable for cryptographic applications, twoxhash is optimized for speed and low collision rates, making it appropriate for internal key-value storage structures. More details on its use are described in the [Storage](./storage) section.
